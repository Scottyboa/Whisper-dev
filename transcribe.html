<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="page-title-transcribe">Transcription Tool with Ads and Guide Overlay</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&family=Merriweather:wght@300;400&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f8f8f8;
      color: #333;
      margin: 0;
      padding: 0;
    }
    /* Cost Indicator */
    #costIndicator {
      position: fixed;
      top: 10px;
      right: 270px;
      background: rgba(255,255,255,0.9);
      border: 1px solid #ccc;
      padding: 10px;
      border-radius: 5px;
      font-size: 14px;
      z-index: 1000;
    }
    /* Grid Layout: Three columns: left sidebar, main content, right ad sidebar */
    .grid-container {
      display: grid;
      grid-template-columns: 250px 1fr 250px;
      height: 100vh;
    }
    /* Left Sidebar */
    .sidebar {
      background-color: #e0e0e0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      position: relative;
    }
    .sidebar button {
      font-size: 18px;
      padding: 15px;
    }
    /* Main Content Area */
    .main-content {
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      overflow-y: auto;
    }
    /* Recording Area (Top Half) */
    .recording-area {
      border-bottom: 1px solid #ddd;
      padding-bottom: 20px;
    }
    .timer {
      font-size: 18px;
      margin-bottom: 10px;
      color: #333;
    }
    /* Textareas with auto-resize */
    #transcription {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      box-sizing: border-box;
      margin-bottom: 20px;
      font-family: 'Roboto', sans-serif;
      resize: none;
      min-height: 150px;
    }
    #generatedNote {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      box-sizing: border-box;
      margin-bottom: 20px;
      font-family: 'Roboto', sans-serif;
      resize: none;
      min-height: 150px;
    }
    #customPrompt {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      box-sizing: border-box;
      margin-bottom: 20px;
      font-family: 'Roboto', sans-serif;
      resize: none;
      min-height: 200px;
    }
    button {
      background-color: #5a9;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 12px 20px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.1s;
      margin: 10px 0;
    }
    button:hover {
      background-color: #489;
    }
    button:active {
      transform: scale(0.98);
    }
    /* Bottom Half: Two Columns */
    .bottom-half {
      display: flex;
      gap: 20px;
      flex: 1;
    }
    .column {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    /* Right Sidebar (Ad Area) */
    .ad-sidebar {
      background-color: #e0e0e0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    #adUnit {
      width: 100%;
      height: 200px;
      background-color: #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      margin-bottom: 10px;
    }
    #impressionCounter {
      font-size: 14px;
      color: #333;
    }
    /* Guide Overlay */
    #guideView {
      display: none;
      position: fixed;
      top: 10%;
      left: 10%;
      width: 80%;
      height: 80%;
      background: white;
      border: 2px solid #ccc;
      padding: 20px;
      overflow-y: auto;
      z-index: 2000;
    }
    #guideView.active {
      display: block;
    }
    /* Language Dropdown in Sidebar (Bottom Left) */
    #lang-select-transcribe {
      position: absolute;
      bottom: 20px;
      left: 20px;
      padding: 5px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div id="costIndicator">
    <span id="costIndicatorText">Total: $0.0000 (~NOK 0.0000)<br>Transcription: $0.0000 (~NOK 0.0000)<br>Note Generation: $0.0000 (~NOK 0.0000)</span>
  </div>
  <div class="grid-container">
    <!-- Left Sidebar -->
    <aside class="sidebar">
      <button id="btnFunctions">Functions</button>
      <button id="btnGuide">Guide</button>
      <select id="lang-select-transcribe">
        <option value="en">English</option>
        <option value="no">Norsk</option>
        <option value="es">Español</option>
        <option value="it">Italiano</option>
        <option value="de">Deutsch</option>
        <option value="pt">Português</option>
        <option value="zh">中文</option>
        <option value="ja">日本語</option>
        <option value="ru">Русский</option>
        <option value="ko">한국어</option>
        <option value="th">ไทย</option>
        <option value="fr">Français</option>
        <option value="sv">Svenska</option>
        <option value="da">Dansk</option>
        <option value="fi">Suomi</option>
      </select>
    </aside>
    <!-- Main Content -->
    <main class="main-content">
      <!-- Top Half: Recording Area -->
      <div class="recording-area">
        <h3 id="recordingAreaTitle">Recording Area</h3>
        <div id="recordIndicator" style="width:20px; height:20px; border-radius:50%; background-color:grey; margin:0 auto 10px;"></div>
        <div id="recordTimer" class="timer">Recording Timer: 0 sec</div>
        <div id="uploadTimer" class="timer">Upload Timer: 0 sec</div>
        <div id="transcribeTimer" class="timer">Transcription Timer: 0 sec</div>
        <textarea id="transcription" placeholder="Transcription result will appear here..."></textarea>
        <div>
          <button id="startButton">Start Recording</button>
          <button id="stopButton" disabled>Stop Recording</button>
          <button id="pauseResumeButton" disabled>Pause Recording</button>
          <button id="transcribeButton" disabled>Transcribe</button>
        </div>
        <div id="statusMessage">Welcome! Click "Start Recording" to begin.</div>
      </div>
      <!-- Bottom Half: Note Generation and Custom Prompt -->
      <div class="bottom-half">
        <div class="column">
          <h3 id="noteGenerationTitle">Note Generation</h3>
          <button id="generateNoteButton">Generate Note</button>
          <div id="noteTimer" class="timer">Note Generation Timer: 0 sec</div>
          <textarea id="generatedNote" readonly placeholder="Generated note will appear here..."></textarea>
        </div>
        <div class="column">
          <h3 id="customPromptTitle">Custom Prompt</h3>
          <label for="promptSlot" id="promptSlotLabel">Prompt Slot:</label>
          <select id="promptSlot">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
          <textarea id="customPrompt" placeholder="Enter custom prompt here" rows="1"></textarea>
        </div>
      </div>
    </main>
    <!-- Right Sidebar (Ad Area) -->
    <aside class="ad-sidebar">
      <div id="adArea">
        <div id="adUnit">Your Ad Here</div>
        <div id="impressionCounter">Impressions: 0</div>
      </div>
    </aside>
  </div>
  <!-- Guide Overlay -->
  <div id="guideView">
    <h3 id="guideHeading">Guide & Instructions</h3>
    <p id="guideText">
      Welcome to the Whisper Transcription tool. This application allows medical professionals, therapists, and other practitioners to record and transcribe consultations, as well as generate professional notes using an AI-powered note generator.
      <br><br>
      <strong>How to Use the Functions:</strong>
      <ul>
        <li><strong>Recording:</strong> Click "Start Recording" to begin capturing audio. Use "Stop Recording" to end and upload your recording.</li>
        <li><strong>Transcription:</strong> Once your audio is uploaded, click "Transcribe" to convert speech to text. The transcription will appear in the top area.</li>
        <li><strong>Note Generation:</strong> After transcription, click "Generate Note" to produce a note based on your transcription and custom prompt. A timer shows the duration of note generation, and the generated note appears below.</li>
        <li><strong>Custom Prompt:</strong> On the right, select a prompt slot (1–10) and enter your custom prompt. Your prompt is saved automatically and linked to your API key.</li>
        <li><strong>Guide Toggle:</strong> Use the "Functions" and "Guide" buttons to switch between the functional view and this guide. The guide appears as an overlay and does not disturb the underlying layout.</li>
      </ul>
      Please click "Functions" to return to the main interface.
    </p>
  </div>
  <script>
    // Auto-resize for textareas
    function autoResizeTextarea(textarea) {
      textarea.style.height = "auto";
      textarea.style.height = textarea.scrollHeight + "px";
    }
    document.getElementById("transcription").addEventListener("input", () => autoResizeTextarea(document.getElementById("transcription")));
    document.getElementById("generatedNote").addEventListener("input", () => autoResizeTextarea(document.getElementById("generatedNote")));
    document.getElementById("customPrompt").addEventListener("input", () => autoResizeTextarea(document.getElementById("customPrompt")));

    // Translation object for index page
    const indexTranslations = {
      en: { /* (Same as above, already provided) */ },
      no: { /* (Same as above) */ },
      es: { /* Spanish translations as provided above */ },
      it: { /* Italian translations as provided above */ },
      de: { /* German translations as provided above */ },
      pt: { /* Portuguese translations as provided above */ },
      zh: { /* Chinese translations as provided above */ },
      ja: { /* Japanese translations as provided above */ },
      ru: { /* Russian translations as provided above */ },
      ko: { /* Korean translations as provided above */ },
      th: { /* Thai translations as provided above */ },
      fr: { /* French translations as provided above */ },
      sv: { /* Swedish translations as provided above */ },
      da: { /* Danish translations as provided above */ },
      fi: { /* Finnish translations as provided above */ }
    };
    // (For brevity, assume the same indexTranslations object is defined with keys for all languages.)
    function updateLanguageIndex(lang) {
      document.getElementById("page-title").textContent = indexTranslations[lang].pageTitle;
      document.getElementById("header-title").textContent = indexTranslations[lang].headerTitle;
      document.getElementById("header-subtitle").textContent = indexTranslations[lang].headerSubtitle;
      document.getElementById("start-text").textContent = indexTranslations[lang].startText;
      document.getElementById("apiKeyInput").setAttribute("placeholder", indexTranslations[lang].apiPlaceholder);
      document.getElementById("enterTranscriptionBtn").textContent = indexTranslations[lang].enterButton;
      document.getElementById("openGuideButton").textContent = indexTranslations[lang].guideButton;
      document.getElementById("ad-revenue-message").textContent = indexTranslations[lang].adRevenueMessage;
      document.getElementById("consent-text").textContent = indexTranslations[lang].consentBannerText;
      document.getElementById("guide-heading").innerHTML = indexTranslations[lang].guideHeading;
      document.getElementById("guide-p1").innerHTML = indexTranslations[lang].guideP1;
      document.getElementById("guide-p2").innerHTML = indexTranslations[lang].guideP2;
      document.getElementById("guide-p3").innerHTML = indexTranslations[lang].guideP3;
      document.getElementById("guide-p4").innerHTML = indexTranslations[lang].guideP4;
      document.getElementById("guide-p5").innerHTML = indexTranslations[lang].guideP5;
      document.getElementById("guide-p6").innerHTML = indexTranslations[lang].guideP6;
    }
    let currentLang = localStorage.getItem("siteLanguage") || "en";
    document.getElementById("lang-select").value = currentLang;
    updateLanguageIndex(currentLang);
    document.getElementById("lang-select").addEventListener("change", function() {
      currentLang = this.value;
      localStorage.setItem("siteLanguage", currentLang);
      updateLanguageIndex(currentLang);
    });

    // Translation object for transcribe page
    const transcribeTranslations = {
      en: { /* (Same as provided in the previous script for English) */ },
      no: { /* (Same as provided above for Norwegian) */ },
      es: { /* (Similar structure using Spanish translations as above) */ },
      it: { /* (Italian translations) */ },
      de: { /* (German translations) */ },
      pt: { /* (Portuguese translations) */ },
      zh: { /* (Chinese translations) */ },
      ja: { /* (Japanese translations) */ },
      ru: { /* (Russian translations) */ },
      ko: { /* (Korean translations) */ },
      th: { /* (Thai translations) */ },
      fr: { /* (French translations) */ },
      sv: { /* (Swedish translations) */ },
      da: { /* (Danish translations) */ },
      fi: { /* (Finnish translations) */ }
    };
    function updateLanguageTranscribe(lang) {
      document.getElementById("page-title-transcribe").textContent = transcribeTranslations[lang].pageTitle;
      document.getElementById("costIndicatorText").innerHTML = transcribeTranslations[lang].costIndicator;
      document.getElementById("btnFunctions").textContent = transcribeTranslations[lang].btnFunctions;
      document.getElementById("btnGuide").textContent = transcribeTranslations[lang].btnGuide;
      document.getElementById("recordingAreaTitle").textContent = transcribeTranslations[lang].recordingAreaTitle;
      document.getElementById("recordTimer").textContent = transcribeTranslations[lang].recordTimer;
      document.getElementById("uploadTimer").textContent = transcribeTranslations[lang].uploadTimer;
      document.getElementById("transcribeTimer").textContent = transcribeTranslations[lang].transcribeTimer;
      document.getElementById("transcription").setAttribute("placeholder", transcribeTranslations[lang].transcriptionPlaceholder);
      document.getElementById("startButton").textContent = transcribeTranslations[lang].startButton;
      document.getElementById("stopButton").textContent = transcribeTranslations[lang].stopButton;
      document.getElementById("pauseResumeButton").textContent = transcribeTranslations[lang].pauseButton;
      document.getElementById("transcribeButton").textContent = transcribeTranslations[lang].transcribeButton;
      document.getElementById("statusMessage").textContent = transcribeTranslations[lang].statusMessage;
      document.getElementById("noteGenerationTitle").textContent = transcribeTranslations[lang].noteGenerationTitle;
      document.getElementById("generateNoteButton").textContent = transcribeTranslations[lang].generateNoteButton;
      document.getElementById("noteTimer").textContent = transcribeTranslations[lang].noteTimer;
      document.getElementById("generatedNote").setAttribute("placeholder", transcribeTranslations[lang].generatedNotePlaceholder);
      document.getElementById("customPromptTitle").textContent = transcribeTranslations[lang].customPromptTitle;
      document.getElementById("promptSlotLabel").textContent = transcribeTranslations[lang].promptSlotLabel;
      document.getElementById("customPrompt").setAttribute("placeholder", transcribeTranslations[lang].customPromptPlaceholder);
      document.getElementById("adUnit").textContent = transcribeTranslations[lang].adUnitText;
      document.getElementById("impressionCounter").textContent = transcribeTranslations[lang].impressionCounter;
      document.getElementById("guideHeading").textContent = transcribeTranslations[lang].guideHeading;
      document.getElementById("guideText").innerHTML = transcribeTranslations[lang].guideText;
    }
    let currentLangTranscribe = localStorage.getItem("siteLanguage") || "en";
    document.getElementById("lang-select-transcribe").value = currentLangTranscribe;
    updateLanguageTranscribe(currentLangTranscribe);
    document.getElementById("lang-select-transcribe").addEventListener("change", function() {
      currentLangTranscribe = this.value;
      localStorage.setItem("siteLanguage", currentLangTranscribe);
      updateLanguageTranscribe(currentLangTranscribe);
    });
    
    // Consent Banner & Cookie Management for transcribe page
    function setCookieTranscribe(name, value, days) {
      var expires = "";
      if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }
    function getCookieTranscribe(name) {
      var nameEQ = name + "=";
      var ca = document.cookie.split(';');
      for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) === ' ') c = c.substring(1);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length);
      }
      return null;
    }
    function loadAdSenseTranscribe() {
      var script = document.createElement('script');
      script.async = true;
      script.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js";
      document.head.appendChild(script);
      (adsbygoogle = window.adsbygoogle || []).push({});
    }
    document.getElementById("cmp-accept").addEventListener("click", function() {
      setCookieTranscribe("user_consent", "accepted", 365);
      document.getElementById("cmp-banner").style.display = "none";
      loadAdSenseTranscribe();
    });
    document.getElementById("cmp-manage").addEventListener("click", function() {
      alert("Here you can manage your cookie and ad preferences.");
    });
    (function() {
      if (getCookieTranscribe("user_consent") === "accepted") {
        document.getElementById("cmp-banner").style.display = "none";
        loadAdSenseTranscribe();
      }
    })();
    
    // Guide Overlay Logic for transcribe page
    const overlayGuide = document.getElementById("guideView");
    const btnGuide = document.getElementById("btnGuide");
    const btnFunctions = document.getElementById("btnFunctions");
    btnGuide.addEventListener("click", () => {
      overlayGuide.classList.add("active");
    });
    btnFunctions.addEventListener("click", () => {
      overlayGuide.classList.remove("active");
    });
    
    // (Additional transcribe functionalities would follow here)
  </script>
</body>
</html>
